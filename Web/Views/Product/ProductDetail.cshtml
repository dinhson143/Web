@using Web.ViewModels.Catalog.Common
@model Web.Models.ProductDetailViewModel
@inject LazZiya.ExpressLocalization.ISharedCultureLocalizer _loc;
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "ProductDetail";
    var culture = CultureInfo.CurrentCulture.Name;
}

@section Scripts{
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="~/css/Comment.css" rel="stylesheet" />

    <script type="text/javascript">
        function formatCash(str) {
            return str.split('').reverse().reduce((prev, next, index) => {
                return ((index % 3) ? next : (next + ',')) + prev
            })
        }
        var listSize = JSON.parse('@Newtonsoft.Json.JsonConvert.SerializeObject(Model.ProductInfo.listPS)'.replace(/&quot;/g, "\""));

        // setSize sản phẩm đầu tiên
        $('#giaSP').text(formatCash(listSize[0].Price.toString())+" VND");
        $('#soluongSP').text(listSize[0].Stock+" ");
        var value = $('#sizeDropdown :selected').val();
        var nameSize = $('#sizeDropdown :selected').text();

        var button = document.getElementById('btnAddToCart');
        button.setAttribute('data-sizeId', value);
        button.setAttribute('data-nameSize', nameSize);
        function chonsize() {
            var value = $('#sizeDropdown :selected').val();
            var nameSize = $('#sizeDropdown :selected').text();

            var button = document.getElementById('btnAddToCart');
            button.setAttribute('data-sizeId', value);
            button.setAttribute('data-nameSize', nameSize);
            for (let j = 0; j < listSize.length; j++) {
                if (listSize[j].SizeId == value) {
                    $('#giaSP').text(formatCash(listSize[j].Price.toString()) + " VND");
                    $('#soluongSP').text(listSize[j].Stock+" ");
                }
            }
        }

        //
        $("#soluongQty").change(function () {
            var button = document.getElementById('btnAddToCart');
            var value = $('#soluongQty').val();
            button.setAttribute('data-qty', value);
        });

        $("#btnAddToCart").click(function () {
            var soluong = $('#soluongQty').val();
            var total = $('#soluongSP').text();
            if (parseInt(soluong) > parseInt(total) || soluong == "") {
                $('.error').show();
                setTimeout(function () {
                    $(".error").fadeOut('slow');
                }, 3000);
                return false;
            }
            $('.success').show();
            setTimeout(function () {
                $(".success").fadeOut('slow');
            }, 3000);
        });

        $('.error').hide();
        $('.success').hide();

    </script>
}

<div class="span9">
    <div class="alert alert-error error">
        <span>Vui lòng kiểm tra lại số lượng</span>
    </div>
    <div class="alert alert-success success">
        <span>Đã thêm sản phẩm vào giỏ hàng</span>
    </div>
    <ul class="breadcrumb">
        <li><a href="/@culture/Home/Index">Home</a> <span class="divider">/</span></li>
        <li class="active">Product Details</li>
    </ul>
    <div class="row">
        <div id="gallery" class="span3">
            @foreach (var image in @Model.Images)
            {
                if (image.isDefault)
                {
                    <a href="@image.URL" title="@image.Caption">
                        <img src="@image.URL" style="width:100%" alt="@image.Caption" />
                    </a>
                }
            }
            <div id="differentview" class="moreOptopm carousel slide">
                <div class="carousel-inner">
                    <div class="item active">
                        @foreach (var image in @Model.Images)
                        {
                            <a href="@image.URL"> <img style="width:29%" src="@image.URL" alt="" /></a>
                        }
                    </div>
                    <div class="item">
                        @foreach (var image in @Model.Images)
                        {
                            <a href="@image.URL"> <img style="width:29%" src="@image.URL" alt="" /></a>
                        }
                    </div>
                </div>
            </div>

            <div class="btn-toolbar">
                <div class="btn-group">
                    <span class="btn"><i class="icon-envelope"></i></span>
                    <span class="btn"><i class="icon-print"></i></span>
                    <span class="btn"><i class="icon-zoom-in"></i></span>
                    <span class="btn"><i class="icon-star"></i></span>
                    <span class="btn"><i class=" icon-thumbs-up"></i></span>
                    <span class="btn"><i class="icon-thumbs-down"></i></span>
                </div>
            </div>
        </div>
        <div class="span6">
            <h3>@Model.ProductInfo.Name</h3>
            <small>@Html.Raw(@Model.ProductInfo.Details)</small>
            <hr class="soft" />
            <form class="form-horizontal qtyFrm">
                <div class="control-group">
                    <label class="control-label"><span id="giaSP"></span></label>
                    <div class="controls">
                        <input id="soluongQty" type="number" class="span1" placeholder="Qty" />
                        <button id="btnAddToCart" data-id="@Model.ProductInfo.Id" class="btn btn-large btn-add-card btn-primary pull-right"><localize>Add to cart</localize><i class=" icon-shopping-cart"></i></button>
                    </div>
                </div>
            </form>

            <hr class="soft" />
            <h4><span id="soluongSP"></span><localize>items in stock</localize></h4>
            <form class="form-horizontal qtyFrm pull-right">
                <div class="control-group">
                    <label class="control-label"><span>Size</span></label>
                    <div class="controls">
                        <select id="sizeDropdown" onchange="return chonsize()" class="span2" asp-items="@(new SelectList(Model.ProductInfo.listPS,"SizeId","Size",Model.ProductInfo.Name))">
                        </select>
                    </div>
                </div>
            </form>
            <hr class="soft clr" />
            <p>
                @Model.ProductInfo.Description
            </p>
            <a class="btn btn-small pull-right" href="#detail">More Details</a>
            <br class="clr" />
            <a href="#" name="detail"></a>
            <hr class="soft" />
        </div>

        <div class="span9">
            <ul id="productDetail" class="nav nav-tabs">
                <li class="active"><a href="#home" data-toggle="tab"><localize>Comments</localize></a></li>
                <li><a href="#profile" data-toggle="tab"><localize>Related Products</localize></a></li>
            </ul>
            <div id="myTabContent" class="tab-content">
                <div class="tab-pane fade active in" id="home">
                    <div class="container bootdey" style="width:100%">
                        <div class="col-md-12 bootstrap snippets">
                            <div class="panel">
                                <div class="panel-body">
                                    <textarea style="width:100%" class="form-control" rows="5" placeholder="What are you thinking?"></textarea>
                                    <div class="mar-top clearfix">
                                        <button class="btn btn-sm btn-primary pull-right" type="submit"><i class="fa fa-pencil fa-fw"></i> Share</button>
                                    </div>
                                </div>
                            </div>
                            <div class="panel">
                                <div class="panel-body">
                                    <!-- Newsfeed Content -->
                                    <!--===================================================-->
                                    <div class="media-block">
                                        <a class="media-left" href="#"><img class="img-circle img-sm" alt="Profile Picture" src="https://bootdey.com/img/Content/avatar/avatar1.png"></a>
                                        <div class="media-body">
                                            <div class="mar-btm">
                                                <a href="#" class="btn-link text-semibold media-heading box-inline">Lisa D.</a>
                                                <p class="text-muted text-sm"><i class="fa fa-mobile fa-lg"></i> - From Mobile - 11 min ago</p>
                                            </div>
                                            <p>consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat.</p>
                                            <div class="pad-ver">
                                                <div class="btn-group">
                                                    <a class="btn btn-sm btn-default btn-hover-success" href="#"><i class="fa fa-thumbs-up"></i></a>
                                                    <a class="btn btn-sm btn-default btn-hover-danger" href="#"><i class="fa fa-thumbs-down"></i></a>
                                                </div>
                                                <a class="btn btn-sm btn-default btn-hover-primary" href="#">Comment</a>
                                            </div>
                                            <hr>

                                            <!-- Comments -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="profile">
                    <div id="myTab" class="pull-right">
                        <a href="#listView" data-toggle="tab"><span class="btn btn-large"><i class="icon-list"></i></span></a>
                        <a href="#blockView" data-toggle="tab"><span class="btn btn-large btn-primary"><i class="icon-th-large"></i></span></a>
                    </div>
                    <br class="clr" />
                    <hr class="soft" />
                    <div class="tab-content">
                        <div class="tab-pane active" id="blockView">
                            <ul class="thumbnails">
                                <li class="span3">
                                    <div class="thumbnail">
                                        <a href="product_details.html"><img src="/themes/images/products/10.jpg" alt="" /></a>
                                        <div class="caption">
                                            <h5>Manicure &amp; Pedicure</h5>
                                            <p>
                                                Lorem Ipsum is simply dummy text.
                                            </p>
                                            <h4 style="text-align:center"><a class="btn" href="product_details.html"> <i class="icon-zoom-in"></i></a> <a class="btn" href="#">Add to <i class="icon-shopping-cart"></i></a> <a class="btn btn-primary" href="#">&euro;222.00</a></h4>
                                        </div>
                                    </div>
                                </li>
                                <li class="span3">
                                    <div class="thumbnail">
                                        <a href="product_details.html"><img src="/themes/images/products/11.jpg" alt="" /></a>
                                        <div class="caption">
                                            <h5>Manicure &amp; Pedicure</h5>
                                            <p>
                                                Lorem Ipsum is simply dummy text.
                                            </p>
                                            <h4 style="text-align:center"><a class="btn" href="product_details.html"> <i class="icon-zoom-in"></i></a> <a class="btn" href="#">Add to <i class="icon-shopping-cart"></i></a> <a class="btn btn-primary" href="#">&euro;222.00</a></h4>
                                        </div>
                                    </div>
                                </li>
                                <li class="span3">
                                    <div class="thumbnail">
                                        <a href="product_details.html"><img src="/themes/images/products/12.jpg" alt="" /></a>
                                        <div class="caption">
                                            <h5>Manicure &amp; Pedicure</h5>
                                            <p>
                                                Lorem Ipsum is simply dummy text.
                                            </p>
                                            <h4 style="text-align:center"><a class="btn" href="product_details.html"> <i class="icon-zoom-in"></i></a> <a class="btn" href="#">Add to <i class="icon-shopping-cart"></i></a> <a class="btn btn-primary" href="#">&euro;222.00</a></h4>
                                        </div>
                                    </div>
                                </li>
                                <li class="span3">
                                    <div class="thumbnail">
                                        <a href="product_details.html"><img src="/themes/images/products/13.jpg" alt="" /></a>
                                        <div class="caption">
                                            <h5>Manicure &amp; Pedicure</h5>
                                            <p>
                                                Lorem Ipsum is simply dummy text.
                                            </p>
                                            <h4 style="text-align:center"><a class="btn" href="product_details.html"> <i class="icon-zoom-in"></i></a> <a class="btn" href="#">Add to <i class="icon-shopping-cart"></i></a> <a class="btn btn-primary" href="#">&euro;222.00</a></h4>
                                        </div>
                                    </div>
                                </li>
                                <li class="span3">
                                    <div class="thumbnail">
                                        <a href="product_details.html"><img src="/themes/images/products/1.jpg" alt="" /></a>
                                        <div class="caption">
                                            <h5>Manicure &amp; Pedicure</h5>
                                            <p>
                                                Lorem Ipsum is simply dummy text.
                                            </p>
                                            <h4 style="text-align:center"><a class="btn" href="product_details.html"> <i class="icon-zoom-in"></i></a> <a class="btn" href="#">Add to <i class="icon-shopping-cart"></i></a> <a class="btn btn-primary" href="#">&euro;222.00</a></h4>
                                        </div>
                                    </div>
                                </li>
                                <li class="span3">
                                    <div class="thumbnail">
                                        <a href="product_details.html"><img src="/themes/images/products/2.jpg" alt="" /></a>
                                        <div class="caption">
                                            <h5>Manicure &amp; Pedicure</h5>
                                            <p>
                                                Lorem Ipsum is simply dummy text.
                                            </p>
                                            <h4 style="text-align:center"><a class="btn" href="product_details.html"> <i class="icon-zoom-in"></i></a> <a class="btn" href="#">Add to <i class="icon-shopping-cart"></i></a> <a class="btn btn-primary" href="#">&euro;222.00</a></h4>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                            <hr class="soft" />
                        </div>
                    </div>
                    <br class="clr">
                </div>
            </div>
        </div>
    </div>
</div>